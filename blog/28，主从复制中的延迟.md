**如何在主库插入记录之后，有可能无法及时更新到从库，导致的时延问题？**

>
>
> 主机和备机之间的物理延迟是不可控和不可避免的，这个问题其实就是如何保证在主机写入之后，一定可以从备机中读取到已经写入的数据，也就是**主从架构的强一致性**



解决方式

- 使用Mysql的Semi-sync功能：在写入主机时，只有确认更新已经同步到到备机之后，再返回写成功操作，但是此种方法要求写操作必须等待更新同步完成，肯定会极大的影响性能，除非对性能不在乎。实际上这种方式只能保证数据不会丢失，但是由于主从复制机制缘故，还是不能保证从备机读取数据时的一致性，因为不会知道备机会在什么时候执行重放，所以即使备机可以达到最终一致性，但是还是可能会出现延迟问题
- 在数据库层之上架构一个redis分布式缓存解决问题
- 有更新数据后的读取相关数据动作，都默认到主库（只能解决普遍问题）
- 插入新的数据，返回last_id，组装成数据，缓存在前端，读取此id数据，先从缓存取（只能解决普遍问题）



另外

- 业务量不大的，主库可以处理就全部放在主库上，从库只做备份，或者对实时性不高的统计报表类工作
- 使用redis周期性的把更新的数据写入数据库



