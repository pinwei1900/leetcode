```Java
private BlockingQueue<SendMq> sendMqs = new ArrayBlockingQueue<>(QUEUE_MAX_SIZE);
for (; ; ) {
    SendMq bmqr = sendMqs.take();
    MsgObj msgObj = JsonUtil.jsonToObject(bmqr.getOriginalContentMsg(), MsgObj.class);
    boolean sendOk = defaultRocketMq.send(msgObj);
    int repCount = 3; //队列重试次数
    int repIdx = 0;
    while (!sendOk) {
        if (repIdx > repCount) {
            sendMqMapperDao.updateSendMq(bmqr.getId(), 2); //失败待重发
            break;
        }
        DateUtil.sleep(1000 * 10 * (Double.valueOf(Math.pow(2, repIdx)).intValue()));
        sendOk = defaultRocketMq.send(msgObj);
        repIdx++;
    }
    if (sendOk) {
        sendMqMapperDao.deleteSendMq(bmqr.getId());
    }
}
```

考虑点：

- 超过发送次数   

- 重发间隔 

- 发送成功 

